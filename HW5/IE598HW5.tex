\documentclass[10pt,onecolumn,letterpaper]{article}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{algorithm, algorithmic}
\begin{document}

\title{IE 598 HW5}
\author{Tanmay Gupta, Peter Maginnis}
\maketitle

5.1a) Sampling from a uniform distribution over the set of perfect matchings is identical to uniformly sampling a random permutation.  Here we may represent a perfect matching as a set of index pairs $\sigma=\{(i,j)\}_{i=1}^n$ such that the collection is bijective.  One simple way to do this is
%\begin{algorithm}
%\raggedright
%  \caption{}
%\begin{algorithmic}
%
%
%\end{algorithmic}
%\end{algorithm}
\begin{algorithm}
\raggedright
  \caption{Uniformly sampling a random permutation}
  \begin{algorithmic}
    \FOR{$i=1$ to $N$}
    \STATE sample $j\sim\operatorname{Unif}\left(\{1,\dotsc, n\}\setminus\{j':(i',j')\in\sigma\ \mathrm{ and }\ i'<i\}\right)$
    \STATE $\sigma\gets\sigma\cup\{(i,j)\}$
     \ENDFOR
  \end{algorithmic}
\end{algorithm}

b) The weighted measure $\mu$ over the set of all perfect matchings $P$ is given by 
\begin{align*}
   \mu(\sigma)&=\frac{1}{Z(w)}\exp\left\{\sum_i w_{i\sigma(i)}\right\}%\mathbb{I}(\sigma\text{ is a perfect matching})
\end{align*}
where
\begin{align*}
  Z(w)&=\sum_{\sigma\in P}\mu(\sigma)\\
  &=\sum_{\sigma\in P}\exp\left\{\sum_i w_{i\sigma(i)}\right\}\\
  &\leq\sum_{\sigma\in P}\exp\left\{\sum_i w^*\right\}\\
  &=\exp\left\{Nw^*\right\}\sum_{\sigma\in P}1\\
  &=N!\exp\left\{Nw^*\right\}.
\end{align*}
Thus we may derive the lower bound
\begin{align*}
   \mu(\sigma)&\geq\frac{1}{N!\exp\left\{Nw^*\right\}}\exp\left\{\sum_i w_{i\sigma(i)}\right\}\\
   &\geq\frac{1}{N!\exp\left\{Nw^*\right\}},
\end{align*}
since $w_{ij}\geq0$ for every $i,j\in\{1,\dotsc,N\}$.

c) Given the Metropolis-Hastings rule that samples $i,i'\sim\operatorname{Unif}(\{1,\dotsc, N\})$ and swaps $\sigma(i)$ and $\sigma(i')$ with probability
\begin{equation*}
 R = \min\left\{1, \exp(-w_{i\sigma(i)}-w_{i'\sigma(i')}+w_{i\sigma(i')}+w_{i'\sigma(i)}) \right\}
\end{equation*}
\end{document}